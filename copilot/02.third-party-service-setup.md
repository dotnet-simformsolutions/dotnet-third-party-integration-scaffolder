# 02.third-party-service-setup.md

## üß™ Task  
Based on the inputs collected in Step 01 (initial-setup.md), Scaffold the code structure inside `/Services/{ServiceName}` dynamically based on project type.

---

## üßæ Dynamic Parameters
Please supply the following runtime parameters:

- `{ServiceName}`: The name of the third-party service (e.g., Stripe, QuickBooks, PayPal or Other)  
- `{ProjectType}`: WebAPI | MVC | Class Library  
- `{AuthenticationType}`: None | JWT | OAuth2 | Cookie | Basic  
- `{IsStandalone}`: `true` = Self-hosted runnable project (includes Program.cs)  
- `{AppType}`: WebAPI or MVC (applies only if `IsStandalone == true`)  
- `{HostProjectPath}`: If `IsStandalone == false` and `{ProjectType} == ClassLibrary`, this must either be:
    - A path to an existing host project (e.g., `C:\Projects\MainApp\MainApp.csproj`)  
    - Or dynamically generated based on user instruction to create a new host project (prompt the user accordingly)

---

## ‚úÖ Step-by-step Scaffolding Instructions

### 1. Folder and File Setup:
Inside `/Services/{ServiceName}`, scaffold the following folders and files:
```
/DTO/Requests
/DTO/Responses
/Common/Helpers
/Common/Configuration
/Docs
```

Create the following key components:

- `/DTO/Requests/`  
    ‚Üí Add a sample DTO class for a request, inferred from the context of `{ServiceName}`.  
- `/DTO/Responses/`  
    ‚Üí Add a sample DTO for expected response payloads.  
- `I{ServiceName}Service.cs`  
    ‚Üí Interface with 1‚Äì2 meaningful async method signatures using the DTOs.  
- `{ServiceName}Service.cs`  
    ‚Üí Implements the interface with logic placeholders or mocked behaviors for demo.  

- `/Extensions/ServiceCollectionExtensions.cs`  
    ‚Üí Contains extension methods to register `{ServiceName}` service and configuration with `IServiceCollection`.  
- `/Docs/README.md`  
    ‚Üí Placeholder to be updated dynamically with integration steps, config, and examples.  

---

### üîÅ If `ProjectType == ClassLibrary`:

- Scaffold this structure inside the class library project root (from `{HostProjectPath}` if already created, or new if created now).  
- Add a project reference from the host project to the class library project.  
- Add the class library to the host solution if not already added.  

---

### üîÅ If `IsStandalone == true`:

- Scaffold this structure inside a subfolder `/Services/{ServiceName}` inside the WebAPI or MVC project.  
- Project root is reserved for core WebAPI or MVC structure (e.g., controllers, middleware, etc.).  

---

### 2. üîê Authentication Setup (Conditional)

If `{AuthenticationType}` is JWT or OAuth2:  
- Generate:
    - `/Common/Helpers/TokenProvider.cs`  
        ‚Üí Contains logic to acquire and cache tokens based on the chosen method.  
- Optionally, create an abstraction `ITokenProvider` for testing and DI purposes.  

---

### 3. ‚öôÔ∏è Configuration Binding

- Create a POCO class `{ServiceName}Options` under `/Common/Configuration/` with public properties inferred automatically based on the `{ServiceName}` integration.  
- Scaffold a matching configuration section in `appsettings.json` with key `{ServiceName}Settings`.  
- In `Program.cs` or `Startup.cs`, bind the configuration section to `{ServiceName}Options` using:  

```csharp
builder.Services.Configure<{ServiceName}Options>(
    builder.Configuration.GetSection("{ServiceName}Settings"));
```

- Register `{ServiceName}Options` for injection via `IOptions<{ServiceName}Options>`.

---

### 4. üåê Endpoints or Actions (Standalone Only)

If `{IsStandalone} == true`:
- Create at least one controller or action based on `{ServiceName}` operations  
- Use best practices:
    - Async  
    - Dependency Injection  
    - Proper DTO usage  
    - Status codes and structured responses  

---

### 5. üìò Update Documentation (README.md)

Continuously update `/Services/{ServiceName}/Docs/README.md` with:
- Overview of the Integration  
- Configuration Steps  
- Required NuGet Packages (auto-resolved during install phase)  
- Environment Variables  
- Authentication Setup  
- Example Requests/Responses  
    - Sample request payloads and endpoint actions  
- Testing Instructions  
- Security Considerations  

Each time you scaffold a component, update the relevant section in the README accordingly.

---

## ‚ö†Ô∏è Important Notes

- Always confirm with the user before scaffolding any folder or file.  
- Ensure all generated code is:
    - Modular and testable  
    - Aligned with .NET naming conventions  
    - Following SOLID principles  
- If `IsStandalone == true`, include a minimal `Program.cs` to enable `dotnet run`  
- All components should support plug-in behavior for future service modules  
- All output should maintain a formal and production-grade tone  
- Before creating any file, folder, project, or solution:
    - Check whether it already exists  
    - If it exists:
        - Prompt user: "‚ö†Ô∏è {Item} already exists. Do you want to skip creation and reuse it? (Yes/No)"  
        - Proceed based on response (skip or overwrite)